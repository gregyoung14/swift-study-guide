# Mocking & Stubbing

## Overview
This section provides a comprehensive guide to mocking and stubbing in iOS testing, essential techniques for isolating units of code and creating controlled test environments. For senior iOS engineers, mastering these concepts is crucial for writing effective, fast, and reliable unit and integration tests, enabling focused testing of specific logic without external dependencies.

## Table of Contents

- [Introduction to Test Doubles](#introduction-to-test-doubles)
    - [The Need for Isolation in Testing (Unit Testing Principle)](#the-need-for-isolation-in-testing-unit-testing-principle)
    - [Types of Test Doubles (Mocks, Stubs, Fakes, Spies, Dummies - The "Test Double" Terminology)](#types-of-test-doubles-mocks-stubs-fakes-spies-dummies-the-test-double-terminology)
    - [Why Use Test Doubles? (Speed, Predictability, Isolation)](#why-use-test-doubles-speed-predictability-isolation)
- [Stubs](#stubs)
    - [Definition and Purpose (Providing Pre-defined Answers to Calls)](#definition-and-purpose-providing-pre-defined-answers-to-calls)
    - [Implementing Stubs in Swift](#implementing-stubs-in-swift)
        - [Manual Stubbing (Custom Structs/Classes Conforming to Protocols)](#manual-stubbing-custom-structsclasses-conforming-to-protocols)
        - [Using Protocols for Stub Definitions](#using-protocols-for-stub-definitions)
    - [When to Use Stubs (Controlling Behavior of Dependencies)](#when-to-use-stubs-controlling-behavior-of-dependencies)
    - [Stubbing Properties and Methods](#stubbing-properties-and-methods)
- [Mocks](#mocks)
    - [Definition and Purpose (Verifying Interactions and Behavior)](#definition-and-purpose-verifying-interactions-and-behavior)
    - [Implementing Mocks in Swift](#implementing-mocks-in-swift)
        - [Manual Mocking (Recording Invocations)](#manual-mocking-recording-invocations)
        - [Mocking Frameworks (e.g., Cuckoo, Mockingbird - Code Generation)](#mocking-frameworks-eg-cuckoo-mockingbird-code-generation)
        - [Verification of Invocations and Arguments](#verification-of-invocations-and-arguments)
    - [When to Use Mocks (Behavioral Testing, Interactions)](#when-to-use-mocks-behavioral-testing-interactions)
- [Fakes](#fakes)
    - [Definition and Purpose (Working Implementations, Simplified for Tests)](#definition-and-purpose-working-implementations-simplified-for-tests)
    - [Implementing Fakes in Swift (e.g., In-Memory Database, Simplified Network Client)](#implementing-fakes-in-swift-eg-in-memory-database-simplified-network-client)
    - [When to Use Fakes (Integration-like Tests, Complex Dependencies)](#when-to-use-fakes-integration-like-tests-complex-dependencies)
- [Spies](#spies)
    - [Definition and Purpose (Partial Mocks, Recording Information for Later Assertion)](#definition-and-purpose-partial-mocks-recording-information-for-later-assertion)
    - [Implementing Spies in Swift (Subclassing, Method Swizzling for advanced cases)](#implementing-spies-in-swift-subclassing-method-swizzling-for-advanced-cases)
    - [When to Use Spies (Observing Side Effects, Function Calls)](#when-to-use-spies-observing-side-effects-function-calls)
- [Dummies](#dummies)
    - [Definition and Purpose (Placeholders, Never Used)](#definition-and-purpose-placeholders-never-used)
    - [When to Use Dummies (Satisfying Parameter Lists)](#when-to-use-dummies-satisfying-parameter-lists)
- [Dependency Injection for Testability (Revisited)](#dependency-injection-for-testability-revisited)
    - [Injecting Test Doubles (Constructor, Property, Method Injection)](#injecting-test-doubles-constructor-property-method-injection)
    - [Using Protocols to Define Dependencies (Key for Testability)](#using-protocols-to-define-dependencies-key-for-testability)
- [Best Practices for Mocking and Stubbing](#best-practices-for-mocking-and-stubbing)
    - [Don't Mock What You Don't Own (Avoid Mocking System Frameworks Directly)](#dont-mock-what-you-dont-own-avoid-mocking-system-frameworks-directly)
    - [Avoid Over-Mocking (Testing Implementation Details vs. Behavior)](#avoid-over-mocking-testing-implementation-details-vs-behavior)
    - [Keep Tests Readable and Maintainable (Clear Intent, Minimal Test Doubles)](#keep-tests-readable-and-maintainable-clear-intent-minimal-test-doubles)
    - [Balance Between Isolation and Realism](#balance-between-isolation-and-realism)
    - [Choosing the Right Test Double](#choosing-the-right-test-double)
    - [Refactoring and Test Doubles](#refactoring-and-test-doubles)
    - [Automating Mock Generation](#automating-mock-generation)
